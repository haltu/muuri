/*!
 * Muuri v0.5.0-dev
 * https://github.com/haltu/muuri
 * Copyright (c) 2015, Haltu Oy
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
/*!
 * muuriLayout v0.5.0-dev
 * Copyright (c) 2016 Niklas Rämö <inramo@gmail.com>
 * Released under the MIT license
 */
!function(t,e){var i,n;if("object"==typeof module&&module.exports){try{i=require("velocity-animate")}catch(t){}try{n=require("hammerjs")}catch(t){}module.exports=e("Muuri",i,n)}else"function"==typeof define&&define.amd?define(["velocity-animate","hammerjs"],function(t,i){return e("Muuri",t,i)}):(i=t.Velocity||t.jQuery&&t.jQuery.Velocity,n=t.Hammer,t.Muuri=e("Muuri",i,n))}("undefined"!=typeof window?window:this,function(t,e,i,n){"use strict";function r(t,e){var i,n,o,s=this;if(st||(st=document.body,wt=X()),t=s._element=typeof t===lt?rt.querySelector(t):t,!st.contains(t))throw new it("Container element must be an existing DOM element");i=s._settings=Q(r.defaultOptions,e),pt[s._id=++yt]=s,s._isDestroyed=!1,s._layout=null,s._emitter=new r.Emitter,s._setSortGroups(i.dragSortGroup),s._sortConnections=i.dragSortWith&&i.dragSortWith.length?[].concat(i.dragSortWith):null,s._itemShowHandler=typeof i.showAnimation===at?i.showAnimation(i.showDuration,i.showEasing,i.visibleStyles):F("show",i.showDuration,i.showEasing,i.visibleStyles),s._itemHideHandler=typeof i.hideAnimation===at?i.hideAnimation(i.hideDuration,i.hideEasing,i.hiddenStyles):F("hide",i.hideDuration,i.hideEasing,i.hiddenStyles),I(t,i.containerClass),s._items=[],typeof(n=i.items)===lt?A(s._element.children).forEach(function(t){("*"===n||vt(t,n))&&s._items.push(new r.Item(s,t))}):(tt.isArray(n)||g(n))&&(s._items=A(n).map(function(t){return new r.Item(s,t)})),(o=!0===(o=i.layoutOnResize)?0:typeof o===dt?o:-1)>=0&&Z.addEventListener("resize",s._resizeHandler=v(function(){s.refreshItems().layout()},o)),i.layoutOnInit&&s.layout(!0)}function o(t,e){var i,n=this,o=t._settings;n._id=++yt,ct[n._id]=n,n._isDestroyed=!1,e.parentNode!==t._element&&t._element.appendChild(e),I(e,o.itemClass),I(e,(i="none"===D(e,"display"))?o.itemHiddenClass:o.itemVisibleClass),n._gridId=t._id,n._element=e,n._child=e.children[0],n._animate=new r.ItemAnimate(n,e),n._animateChild=new r.ItemAnimate(n,n._child),n._isDefaultAnimate=n._animate instanceof a,n._isActive=!i,n._isPositioning=!1,n._isHidden=i,n._isHiding=!1,n._isShowing=!1,n._layoutAnimateInitRead=null,n._layoutAnimateInitWrite=null,n._visibilityQueue=[],n._layoutQueue=[],n._left=0,n._top=0,b(e,{left:"0",top:"0",transform:"translateX(0px) translateY(0px)",display:i?"none":"block"}),n._refreshDimensions()._refreshSortData(),i?t._itemHideHandler.start(n,!0):t._itemShowHandler.start(n,!0),n._migrate=new r.ItemMigrate(n),n._release=new r.ItemRelease(n),n._drag=o.dragEnabled?new r.ItemDrag(n):null}function s(){this._events={},this._isDestroyed=!1}function a(e,i){this._item=e,this._element=i,this._id=t+"-"+ ++yt,this._callback=null,this._animateTo=null,this._isAnimating=!1,this._isDestroyed=!1}function l(t){var e=this;e._itemId=t._id,e._isDestroyed=!1,e.isActive=!1,e.container=!1,e.containerDiffX=0,e.containerDiffY=0}function d(t){var e=this;e._itemId=t._id,e._isDestroyed=!1,e.isActive=!1,e.isPositioningStarted=!1,e.containerDiffX=0,e.containerDiffY=0}function h(e){if(!i)throw new it("["+t+"] required dependency Hammer is not defined.");var n,r,o=this,s=e._element,a=e.getGrid(),l=a._settings,d=typeof l.dragStartPredicate===at?l.dragStartPredicate:h.defaultStartPredicate,f=ht;o._itemId=e._id,o._gridId=a._id,o._hammer=n=new i.Manager(s),o._isDestroyed=!1,o._isMigrating=!1,o._data={},o._resolveStartPredicate=function(t){o._isDestroyed||f!==ft||(f=ut,o.onStart(t))},o._scrollListener=function(t){o.onScroll(t)},o._checkSortOverlap=v(function(){o._data.isActive&&o.checkOverlap()},l.dragSortInterval),o._sortPredicate=typeof l.dragSortPredicate===at?l.dragSortPredicate:h.defaultSortPredicate,o.reset(),n.add(new i.Pan({event:"drag",pointers:1,threshold:0,direction:i.DIRECTION_ALL})),n.add(new i.Press({event:"draginit",pointers:1,threshold:1e3,time:0})),c(l.dragHammerSettings)&&n.set(l.dragHammerSettings),n.on("draginit dragstart dragmove",function(t){f===ht&&(f=ft),f===ft?!0===(r=d(o.getItem(),t))?(f=ut,o.onStart(t)):!1===r&&(f=_t):f===ut&&o._data.isActive&&o.onMove(t)}).on("dragend dragcancel draginitup",function(t){var e=f===ut;d(o.getItem(),t),f=ht,e&&o._data.isActive&&o.onEnd(t)}),s.addEventListener("dragstart",B,!1)}function f(t,e){var i=t.length,n=i-1;return e>n?n:e<0?et.max(i+e,0):e}function u(t,e,i){if(!(t.length<2)){var n,r=f(t,e),o=f(t,i);r!==o&&(n=t[r],t[r]=t[o],t[o]=n)}}function _(t,e,i){if(!(t.length<2)){var n=f(t,e),r=f(t,i);n!==r&&t.splice(r,0,t.splice(n,1)[0])}}function p(t){var e,i=[],n=t.length;if(n)for(i[0]=t[0],e=1;e<n;e++)i.indexOf(t[e])<0&&i.push(t[e]);return i}function c(t){return"object"==typeof t&&"[object Object]"===$.prototype.toString.call(t)}function g(t){var e=$.prototype.toString.call(t);return"[object HTMLCollection]"===e||"[object NodeList]"===e}function m(t,e){return $.keys(e).forEach(function(i){var n=c(e[i]);c(t[i])&&n?(t[i]=m({},t[i]),t[i]=m(t[i],e[i])):t[i]=n?m({},e[i]):tt.isArray(e[i])?e[i].concat():e[i]}),t}function y(t,e,i){var n=typeof i===dt?i:-1;t.splice.apply(t,[n<0?t.length-n+1:n,0].concat(e))}function v(t,e){var i;return e>0?function(r){i!==n&&(i=Z.clearTimeout(i),"finish"===r&&t()),"cancel"!==r&&"finish"!==r&&(i=Z.setTimeout(function(){i=n,t()},e))}:function(e){"cancel"!==e&&t()}}function D(t,e){return Z.getComputedStyle(t,null).getPropertyValue("transform"===e?Dt.styleName||e:e)}function w(t,e){return parseFloat(D(t,e))||0}function S(t,e){return parseFloat((D(t,"transform")||"").replace("matrix(","").split(",")["x"===e?4:5])||0}function b(t,e){var i,n,r,o=$.keys(e);for(r=0;r<o.length;r++)n=e[i=o[r]],t.style["transform"===i&&Dt?Dt.propName:i]=n}function x(t,i){var n,r=$.keys(i);for(n=0;n<r.length;n++)e.hook(t,r[n],i[r[n]])}function I(t,e){t.classList?t.classList.add(e):vt(t,"."+e)||(t.className+=" "+e)}function C(t,e){t.classList?t.classList.remove(e):vt(t,"."+e)&&(t.className=(" "+t.className+" ").replace(" "+e+" "," ").trim())}function A(t){return[].slice.call(t)}function H(t,e,i){if(t===e)return{left:0,top:0};i&&(t=G(t,!0),e=G(e,!0));var n=E(t,!0),r=E(e,!0);return{left:r.left-n.left,top:r.top-n.top}}function E(t,e){var i,n={left:0,top:0};return t===rt?n:(n.left=Z.pageXOffset||0,n.top=Z.pageYOffset||0,t.self===Z.self?n:(i=t.getBoundingClientRect(),n.left+=i.left,n.top+=i.top,e&&(n.left+=w(t,"border-left-width"),n.top+=w(t,"border-top-width")),n))}function G(t,e){for(var i=(e?t:t.parentElement)||rt;i&&i!==rt&&"static"===D(i,"position")&&!Y(i);)i=i.parentElement||rt;return i}function R(t){var e=[],i=/(auto|scroll)/,n=t.parentNode;if(wt){if("fixed"===D(t,"position"))return e;for(;n&&n!==rt&&n!==ot;)i.test(D(n,"overflow")+D(n,"overflow-y")+D(n,"overflow-x"))&&e.push(n),n="fixed"===D(n,"position")?null:n.parentNode;null!==n&&e.push(Z)}else{for(;n&&n!==rt;)"fixed"!==D(t,"position")||Y(n)?(i.test(D(n,"overflow")+D(n,"overflow-y")+D(n,"overflow-x"))&&e.push(n),t=n,n=n.parentNode):n=n.parentNode;e[e.length-1]===ot?e[e.length-1]=Z:e.push(Z)}return e}function X(){if(!Dt)return!0;var t=[0,1].map(function(t,e){return t=rt.createElement("div"),b(t,{position:e?"fixed":"absolute",display:"block",visibility:"hidden",left:e?"0px":"1px",transform:"none"}),t}),e=st.appendChild(t[0]),i=e.appendChild(t[1]),n=i.getBoundingClientRect().left;b(e,{transform:"scale(1)"});var r=n===i.getBoundingClientRect().left;return st.removeChild(e),r}function Y(t){var e=D(t,"transform"),i=D(t,"display");return"none"!==e&&"inline"!==i&&"none"!==i}function P(t,e){return U.doRectsOverlap(t,e)?(et.min(t.left+t.width,e.left+e.width)-et.max(t.left,e.left))*(et.min(t.top+t.height,e.top+e.height)-et.max(t.top,e.top))/(et.min(t.width,e.width)*et.min(t.height,e.height))*100:0}function L(t){var e,i={};for(e=0;e<t.length;e++)i[t[e]._id]=e;return i}function k(t,e,i,n){var r=n[t._id],o=n[e._id];return i?o-r:r-o}function O(t,e,i,n){var r,o,s,a,l,d=0;for(l=0;l<n.length;l++)if(r=n[l][0],o=n[l][1],s=(t._sortData?t:t._refreshSortData())._sortData[r],a=(e._sortData?e:e._refreshSortData())._sortData[r],0!==(d="desc"===o||!o&&i?a<s?-1:a>s?1:0:s<a?-1:s>a?1:0))return d;return d}function M(t,e){var i,n,r,o=[],s=t.concat();for(r=0;r<e.length;r++)i=e[r],(n=s.indexOf(i))>-1&&(o.push(i),s.splice(n,1));return tt.prototype.splice.apply(t,[0,t.length].concat(o).concat(s)),t}function N(t,e,i){return i.width&&i.height&&t>=i.left&&t<i.left+i.width&&e>=i.top&&e<i.top+i.height}function T(t,e,i,r){var o,s,a=t.getItems(i),l=r||{},d=!0===l.instant,h=l.onFinish,f=l.layout?l.layout:l.layout===n,u=a.length,_="show"===e,p=_?bt:It,c=_?xt:Ct,g=!1,m=[],y=[];if(u){for(t._emit(p,a.concat()),s=0;s<a.length;s++)o=a[s],(_&&!o._isActive||!_&&o._isActive)&&(g=!0),_&&!o._isActive&&(o._skipNextLayoutAnimation=!0),_&&o._isHidden&&y.push(o),o["_"+e](d,function(e,i){e||m.push(i),--u<1&&(typeof h===at&&h(m.concat()),t._emit(c,m.concat()))});y.length&&t.refreshItems(y),g&&f&&t.layout("instant"===f,typeof f===at?f:n)}else typeof h===at&&h(a);return t}function F(t,e,i,n){e=parseInt(e)||0,i=i||"ease",n=c(n)?n:null;var r=e>0;return{start:function(t,o,s){r&&n?o?((t._isDefaultAnimate?x:b)(t._child,n),s&&s()):t._animateChild.start(null,n,{duration:e,easing:i,onFinish:s}):s&&s()},stop:function(t){t._animateChild.stop()}}}function W(t,e,i){var n,r,o,s=null,a=e._getSortConnections(!0),l=-1;for(o=0;o<a.length;o++)(r=a[o])._refreshDimensions(),(n=P(t,{width:r._width,height:r._height,left:r._left,top:r._top}))>i&&n>l&&(l=n,s=r);return s}function V(t,e,i){var n,r=t.splice(0,t.length);for(n=0;n<r.length;n++)r[n](e,i)}function z(t,e){var i;return"inactive"===e?!t.isActive():"hidden"===e?!t.isVisible():(i="is"+e.charAt(0).toUpperCase()+e.slice(1),typeof t[i]===at&&t[i]())}function B(t){t.preventDefault&&t.preventDefault()}function Q(t,e){var i=m({},t);return i=e?m(i,e):i,i.visibleStyles=(e||{}).visibleStyles||(t||{}).visibleStyles,i.hiddenStyles=(e||{}).hiddenStyles||(t||{}).hiddenStyles,i}function j(t,e){var i,n=t._drag._startPredicateData;if(!(e.distance<n.distance||n.delay))return i=n.handleElement.getBoundingClientRect(),q(t),N(e.srcEvent.pageX,e.srcEvent.pageY,{width:i.width,height:i.height,left:i.left+(Z.pageXOffset||0),top:i.top+(Z.pageYOffset||0)})}function q(t){var e=t._drag._startPredicateData;e&&(e.delayTimer&&(e.delayTimer=Z.clearTimeout(e.delayTimer)),t._drag._startPredicateData=null)}function U(t,e,i,n){var r,o,s,a,l,d,h,f=!!n.fillGaps,u=!!n.horizontal,_=!!n.alignRight,p=!!n.alignBottom,c=!!n.rounding,g={slots:{},width:u?0:c?et.round(e):e,height:u?c?et.round(i):i:0,setWidth:u,setHeight:!u},m=[];if(!t.length)return g;for(h=0;h<t.length;h++)l=(a=t[h])._width+a._margin.left+a._margin.right,d=a._height+a._margin.top+a._margin.bottom,c&&(l=et.round(l),d=et.round(d)),s=(o=U.getSlot(g,m,l,d,!u,f))[0],m=o[1],u?g.width=et.max(g.width,s.left+s.width):g.height=et.max(g.height,s.top+s.height),g.slots[a._id]=s;if(_||p)for(r=$.keys(g.slots),h=0;h<r.length;h++)s=g.slots[r[h]],_&&(s.left=g.width-(s.left+s.width)),p&&(s.top=g.height-(s.top+s.height));return g}var J,K,Z=window,$=Z.Object,tt=Z.Array,et=Z.Math,it=Z.Error,nt=Z.Element,rt=Z.document,ot=rt.documentElement,st=rt.body,at="function",lt="string",dt="number",ht=0,ft=1,ut=2,_t=3,pt={},ct={},gt={},mt=function(){},yt=0,vt=function(){var t=nt.prototype,e=t.matches||t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector;return function(t,i){return e.call(t,i)}}(),Dt=function(t){var e,i,r,o=t.charAt(0).toUpperCase()+t.slice(1),s=["","Webkit","Moz","O","ms"];for(r=0;r<s.length;r++)if(e=s[r],i=e?e+o:t,ot.style[i]!==n)return e=e.toLowerCase(),{prefix:e,propName:i,styleName:e?"-"+e+"-"+t:t};return null}("transform"),wt=st?X():null,St="layoutEnd",bt="showStart",xt="showEnd",It="hideStart",Ct="hideEnd";return r.Item=o,r.ItemDrag=h,r.ItemRelease=d,r.ItemMigrate=l,r.ItemAnimate=a,r.Layout=function(t,e){e=e.concat(),t._refreshDimensions();var i=this,n=t._settings.layout,r=t._width-t._border.left-t._border.right,o=t._height-t._border.top-t._border.bottom,s=typeof n===at?n(e,r,o):U(e,r,o,c(n)?n:{});i.slots=s.slots,i.setWidth=s.setWidth||!1,i.setHeight=s.setHeight||!1,i.width=s.width,i.height=s.height},r.Emitter=s,r.defaultOptions={items:"*",showDuration:300,showEasing:"ease",hideDuration:300,hideEasing:"ease",showAnimation:null,hideAnimation:null,visibleStyles:{opacity:1,scale:1},hiddenStyles:{opacity:0,scale:.5},layout:{fillGaps:!1,horizontal:!1,alignRight:!1,alignBottom:!1,rounding:!0},layoutOnResize:100,layoutOnInit:!0,layoutDuration:300,layoutEasing:"ease",sortData:null,dragEnabled:!1,dragContainer:null,dragStartPredicate:{distance:0,delay:0,handle:!1},dragAxis:null,dragSort:!0,dragSortInterval:100,dragSortPredicate:{threshold:50,action:"move"},dragSortGroup:null,dragSortWith:null,dragReleaseDuration:300,dragReleaseEasing:"ease",dragHammerSettings:{touchAction:"none"},containerClass:"muuri",itemClass:"muuri-item",itemVisibleClass:"muuri-item-shown",itemHiddenClass:"muuri-item-hidden",itemPositioningClass:"muuri-item-positioning",itemDraggingClass:"muuri-item-dragging",itemReleasingClass:"muuri-item-releasing"},r.prototype.on=function(t,e){return this._isDestroyed||this._emitter.on(t,e),this},r.prototype.once=function(t,e){return this._isDestroyed||this._emitter.once(t,e),this},r.prototype.off=function(t,e){return this._isDestroyed||this._emitter.off(t,e),this},r.prototype.getElement=function(){return this._element},r.prototype.getItems=function(t,e){var i,n,r=this,o=0===t||t&&typeof t!==lt,s=o?g(t)?A(t):[].concat(t):null,a=o?e:t,l=[];if(r._isDestroyed)return l;if((a=typeof a===lt?a:null)||s){for(s=s||r._items,n=0;n<s.length;n++)!(i=o?r._getItem(s[n]):s[n])||a&&!z(i,a)||l.push(i);return l}return l.concat(r._items)},r.prototype.refreshItems=function(t){var e,i,n=this;if(!n._isDestroyed)for(e=n.getItems(t||"active"),i=0;i<e.length;i++)e[i]._refreshDimensions();return n},r.prototype.refreshSortData=function(t){var e,i,n=this;if(!n._isDestroyed)for(e=n.getItems(t),i=0;i<e.length;i++)e[i]._refreshSortData();return n},r.prototype.synchronize=function(){var t,e,i,n=this,r=n._element,o=n._items;if(n._isDestroyed)return n;if(o.length){for(i=0;i<o.length;i++)(e=o[i]._element).parentNode===r&&(t=t||rt.createDocumentFragment()).appendChild(e);t&&r.appendChild(t)}return n._emit("synchronize"),n},r.prototype.layout=function(t,e){function i(){--_<=0&&(typeof f===at&&f(h._layout!==n,o.concat()),h._layout===n&&h._emit(St,o.concat()))}var n,o,s,a,l,d,h=this,f=typeof t===at?t:e,u=!0===t,_=0;if(h._isDestroyed)return h;if(o=h.getItems("active"),n=h._layout=new r.Layout(h,o),_=o.length,(n.setWidth||n.setHeight)&&(s="border-box"===D(h._element,"box-sizing"),n.setHeight&&b(h._element,{height:(s?n.height+h._border.top+h._border.bottom:n.height)+"px"}),n.setWidth&&b(h._element,{width:(s?n.width+h._border.left+h._border.right:n.width)+"px"})),h._emit("layoutStart",o.concat()),!o.length)return i(),h;for(J=Z.innerWidth,K=Z.innerHeight,d=0;d<o.length;d++)a=o[d],l=n.slots[a._id],a._left=l.left,a._top=l.top,a.isDragging()?i():a._layout(u,i);return h},r.prototype.add=function(t,e){var i,o,s,a=this,l=[].concat(t),d=e||{},h=d.layout?d.layout:d.layout===n,f=[],u=a._items,_=!1;if(a._isDestroyed)return[];for(s=0;s<u.length;s++)(i=l.indexOf(u[s]._element))>-1&&l.splice(i,1);if(!l.length)return f;for(s=0;s<l.length;s++)o=new r.Item(a,l[s]),f.push(o),o._isActive&&(_=!0,o._skipNextLayoutAnimation=!0);return y(u,f,d.index),a._emit("add",f.concat()),_&&h&&a.layout("instant"===h,typeof h===at?h:n),f},r.prototype.remove=function(t,e){var i,r,o,s=this,a=e||{},l=a.layout?a.layout:a.layout===n,d=!1;if(s._isDestroyed)return[];for(i=s.getItems(t),o=0;o<i.length;o++)(r=i[o])._isActive&&(d=!0),r._destroy(a.removeElements);return s._emit("remove",i.concat()),d&&l&&s.layout("instant"===l,typeof l===at?l:n),i},r.prototype.show=function(t,e){return this._isDestroyed?this:T(this,"show",t,e)},r.prototype.hide=function(t,e){return this._isDestroyed?this:T(this,"hide",t,e)},r.prototype.filter=function(t,e){var i,r,o,s=this,a=s._items,l=typeof t,d=l===lt,h=l===at,f=e||{},u=!0===f.instant,_=f.layout?f.layout:f.layout===n,p=typeof f.onFinish===at?f.onFinish:null,c=[],g=[],m=-1;if(s._isDestroyed||!a.length)return s;if(i=p?function(){++m&&p(c.concat(),g.concat())}:mt,h||d)for(o=0;o<a.length;o++)r=a[o],(h?t(r):vt(r._element,t))?c.push(r):g.push(r);return c.length?s.show(c,{instant:u,onFinish:i,layout:!1}):i(),g.length?s.hide(g,{instant:u,onFinish:i,layout:!1}):i(),(c.length||g.length)&&(s._emit("filter",c.concat(),g.concat()),_&&s.layout("instant"===_,typeof _===at?_:n)),s},r.prototype.sort=function(t,e){var i,r,o=this,s=o._items,a=e||{},l=!!a.descending,d=a.layout?a.layout:a.layout===n;if(o._isDestroyed||s.length<2)return o;if(i=s.concat(),typeof t===at)s.sort(function(e,n){var o=t(e,n);return(l&&0!==o?-o:o)||k(e,n,l,r||(r=L(i)))});else if(typeof t===lt)t=t.trim().split(" ").map(function(t){return t.split(":")}),s.sort(function(e,n){return O(e,n,l,t)||k(e,n,l,r||(r=L(i)))});else{if(!tt.isArray(t))return o;M(s,t),l&&s.reverse()}return o._emit("sort",s.concat(),i),d&&o.layout("instant"===d,typeof d===at?d:n),o},r.prototype.move=function(t,e,i){var r,o,s,a,l=this,d=l._items,h=i||{},f=h.layout?h.layout:h.layout===n,p="swap"===h.action,c=p?"swap":"move";return l._isDestroyed||d.length<2?l:(r=l._getItem(t),o=l._getItem(e),r&&o&&r!==o&&(s=d.indexOf(r),a=d.indexOf(o),(p?u:_)(d,s,a),l._emit("move",{item:r,fromIndex:s,toIndex:a,action:c}),f&&l.layout("instant"===f,typeof f===at?f:n)),l)},r.prototype.send=function(t,e,i,r){if(this._isDestroyed||e._isDestroyed||this===e)return this;var o=this,s=e,a=r||{},l=a.appendTo||st,d=a.layoutSender?a.layoutSender:a.layoutSender===n,h=a.layoutReceiver?a.layoutReceiver:a.layoutReceiver===n;return(t=o._getItem(t))?(t._migrate.start(s,i,l),t._migrate.isActive&&t.isActive()&&(d&&o.layout("instant"===d,typeof d===at?d:n),h&&s.layout("instant"===h,typeof h===at?h:n)),o):o},r.prototype.destroy=function(t){var e,i=this,r=i._element,o=i._items.concat();if(i._isDestroyed)return i;for(i._resizeHandler&&Z.removeEventListener("resize",i._resizeHandler),e=0;e<o.length;e++)o[e]._destroy(t);return i._unsetSortGroups(),C(r,i._settings.containerClass),b(r,{height:""}),i._emit("destroy"),i._emitter.destroy(),pt[i._id]=n,i._isDestroyed=!0,i},r.prototype._getItem=function(t){var e,i,n,r,s=this;if(s._isDestroyed||!t)return s._items[0]||null;if(t instanceof o)return t._gridId===s._id?t:null;if(typeof t===dt)return e=t>-1?t:s._items.length+t,s._items[e]||null;for(i=null,r=0;r<s._items.length;r++)if((n=s._items[r])._element===t){i=n;break}return i},r.prototype._emit=function(){return this._isDestroyed||this._emitter.emit.apply(this._emitter,arguments),this},r.prototype._refreshDimensions=function(){var t,e=this,i=e._element,n=i.getBoundingClientRect(),r=["left","right","top","bottom"];for(e._width=n.width,e._height=n.height,e._left=n.left,e._top=n.top,e._border={},t=0;t<r.length;t++)e._border[r[t]]=w(i,"border-"+r[t]+"-width");return e},r.prototype._setSortGroups=function(t){var e=this,i=[];return e._sortGroups=null,[].concat(t).forEach(function(t){"string"==typeof t&&i.indexOf(t)<0&&(i.push(t),gt[t]||(gt[t]=[]),gt[t].push(e._id))}),i.length&&(e._sortGroups=i),e},r.prototype._unsetSortGroups=function(){var t,e,i,n=this,r=n._sortGroups;if(r){for(e=0;e<r.length;e++)for(t=gt[r[e]],i=0;i<t.length;i++)if(t[i]===n._id){t.splice(i,1);break}n._sortGroups=null}return n},r.prototype._getSortConnections=function(t){var e,i,n,r,o=this,s=t?[o]:[],a=o._sortConnections;if(o._isDestroyed)return s;if(a&&a.length)for(r=0;r<a.length;r++)if((e=gt[a[r]])&&e.length)for(n=0;n<e.length;n++)(i=pt[e[n]])!==o&&s.indexOf(i)<0&&s.push(i);return s},o.prototype.getGrid=function(){return pt[this._gridId]},o.prototype.getElement=function(){return this._element},o.prototype.getWidth=function(){return this._width},o.prototype.getHeight=function(){return this._height},o.prototype.getMargin=function(){return{left:this._margin.left,right:this._margin.right,top:this._margin.top,bottom:this._margin.bottom}},o.prototype.getPosition=function(){return{left:this._left,top:this._top}},o.prototype.isActive=function(){return this._isActive},o.prototype.isVisible=function(){return!this._isHidden},o.prototype.isShowing=function(){return this._isShowing},o.prototype.isHiding=function(){return this._isHiding},o.prototype.isPositioning=function(){return this._isPositioning},o.prototype.isDragging=function(){return!!this._drag&&this._drag._data.isActive},o.prototype.isReleasing=function(){return this._release.isActive},o.prototype.isDestroyed=function(){return this._isDestroyed},o.prototype._refreshDimensions=function(){var t,e,i,n,r,o,s=this;if(s._isDestroyed||s._isHidden)return s;for(e=(t=s._element).getBoundingClientRect(),s._width=e.width,s._height=e.height,i=["left","right","top","bottom"],r=s._margin=s._margin||{},o=0;o<4;o++)n=w(t,"margin-"+i[o]),r[i[o]]=n>0?n:0;return s},o.prototype._refreshSortData=function(){var t,e,i=this;return i._isDestroyed||(t={},(e=i.getGrid()._settings.sortData)&&$.keys(e).forEach(function(n){t[n]=e[n](i,i._element)}),i._sortData=t),i},o.prototype._layout=function(t,e){var i,n,r,o,s,a,l,d,h,f=this,u=f._element,_=f._isPositioning,p=f._migrate,c=f._release,g=c.isActive&&!1===c.isPositioningStarted;if(f._isDestroyed)return f;if(i=f.getGrid(),n=i._settings,r=g?n.dragReleaseDuration:n.layoutDuration,o=g?n.dragReleaseEasing:n.layoutEasing,s=!t&&!f._skipNextLayoutAnimation&&r>0,_&&V(f._layoutQueue,!0,f),g&&(c.isPositioningStarted=!0),typeof e===at&&f._layoutQueue.push(e),a=c.isActive?c.containerDiffX:p.isActive?p.containerDiffX:0,l=c.isActive?c.containerDiffY:p.isActive?p.containerDiffY:0,s){if(d=S(u,"x")-a,h=S(u,"y")-l,f._left===d&&f._top===h)return void f._stopLayout()._finishLayout();_||(f._isPositioning=!0,I(u,n.itemPositioningClass)),f._animate.start({translateX:d+a+"px",translateY:h+l+"px"},{translateX:f._left+a+"px",translateY:f._top+l+"px"},{duration:r,easing:o,onFinish:function(){f._finishLayout()}})}else f._stopLayout(),f._skipNextLayoutAnimation=!1,b(u,{transform:"translateX("+(f._left+a)+"px) translateY("+(f._top+l)+"px)"}),f._finishLayout();return f},o.prototype._finishLayout=function(){var t=this;return t._isDestroyed?t:(t._isPositioning&&(t._isPositioning=!1,C(t._element,t.getGrid()._settings.itemPositioningClass)),t._release.isActive&&t._release.stop(),t._migrate.isActive&&t._migrate.stop(),V(t._layoutQueue,!1,t),t)},o.prototype._stopLayout=function(t){var e=this;return e._isDestroyed||!e._isPositioning?e:(e._animate.stop(),C(e._element,e.getGrid()._settings.itemPositioningClass),e._isPositioning=!1,t&&V(e._layoutQueue,!0,e),e)},o.prototype._show=function(t,e){var i,n,r=this,o=r._element,s=r._visibilityQueue,a=typeof e===at?e:null;return r._isDestroyed?r:r._isShowing||r._isHidden?(i=r.getGrid(),n=i._settings,r._isShowing?(a&&s.push(a),t&&i._itemShowHandler.stop(r)):(r._isHidden&&i._itemHideHandler.stop(r),V(s,!0,r),r._isActive=r._isShowing=!0,r._isHiding=r._isHidden=!1,a&&s.push(a),b(o,{display:"block"}),C(o,n.itemHiddenClass),I(o,n.itemVisibleClass)),i._itemShowHandler.start(r,t,function(){r._isShowing=!1,V(s,!1,r)}),r):(a&&a(!1,r),r)},o.prototype._hide=function(t,e){var i,n,r=this,o=r._element,s=r._visibilityQueue,a=typeof e===at?e:null;return r._isDestroyed?r:(i=r.getGrid(),n=i._settings,!r._isHiding&&r._isHidden?(a&&a(!1,r),r):(r._isHiding?(a&&s.push(a),t&&i._itemHideHandler.stop(r)):(r._isShowing&&i._itemShowHandler.stop(r),V(s,!0,r),r._isHidden=r._isHiding=!0,r._isActive=r._isShowing=!1,a&&s.push(a),I(o,n.itemHiddenClass),C(o,n.itemVisibleClass)),i._itemHideHandler.start(r,t,function(){r._isHiding=!1,r._stopLayout(!0),b(o,{display:"none"}),V(s,!1,r)}),r))},o.prototype._destroy=function(t){var e,i,r,o=this,s=o._element;return o._isDestroyed?o:(e=o.getGrid(),i=e._settings,r=e._items.indexOf(o),o._release.destroy(),o._migrate.destroy(),o._stopLayout(!0),e._itemShowHandler.stop(o),e._itemHideHandler.stop(o),o._drag&&o._drag.destroy(),o._animate.destroy(),o._animateChild.destroy(),s.removeAttribute("style"),o._child.removeAttribute("style"),V(o._visibilityQueue,!0,o),C(s,i.itemPositioningClass),C(s,i.itemDraggingClass),C(s,i.itemReleasingClass),C(s,i.itemClass),C(s,i.itemVisibleClass),C(s,i.itemHiddenClass),r>-1&&e._items.splice(r,1),t&&s.parentNode.removeChild(s),ct[o._id]=n,o._isActive=o._isPositioning=o._isHiding=o._isShowing=!1,o._isDestroyed=o._isHidden=!0,o)},s.prototype.on=function(t,e){if(this._isDestroyed)return this;var i=this._events[t]||[];return i.push(e),this._events[t]=i,this},s.prototype.once=function(t,e){var i=this;return this.on(t,function n(){i.off(t,n),e.apply(null,arguments)})},s.prototype.off=function(t,e){if(this._isDestroyed)return this;for(var i=this._events[t]||[],n=i.length;n--;)e===i[n]&&i.splice(n,1);return this},s.prototype.emit=function(t,e,i,n){if(this._isDestroyed)return this;var r,o=this._events[t]||[],s=o.length,a=arguments.length-1;if(s)for(o=o.concat(),r=0;r<s;r++)0===a?o[r]():1===a?o[r](e):2===a?o[r](e,i):o[r](e,i,n);return this},s.prototype.destroy=function(){if(this._isDestroyed)return this;var t,e=$.keys(this._events);for(t=0;t<e.length;t++)this._events[e[t]]=null;return this._isDestroyed=!0,this},a.prototype.start=function(t,i,n){if(!this._isDestroyed){var r=this,o=r._element,s=n||{},a=typeof s.onFinish===at?s.onFinish:null,l=r._isAnimating;if(l){if(!r._shouldStop(i))return void(r._callback=a);r.stop()}r._isAnimating=!0,r._animateTo=i,r._callback=a,r._shouldAnimate(t,i)?(!l&&t&&x(o,t),e(o,i,{duration:s.duration||300,easing:s.easing||"ease",queue:r._id,complete:function(){r._onFinish()}}),e.Utilities.dequeue(o,r._id)):(x(o,i),r._onFinish())}},a.prototype.stop=function(){var t=this;!t._isDestroyed&&t._isAnimating&&(t._isAnimating=!1,t._callback=t._animateTo=null,e(t._element,"stop",t._id))},a.prototype.destroy=function(){var t=this;t._isDestroyed||(t.stop(),t._item=t._element=null,t._isDestroyed=!0)},a.prototype._onFinish=function(){var t=this,e=t._callback;t._isAnimating=!1,t._callback=t._animateTo=null,e&&e()},a.prototype._shouldStop=function(t){var e,i=$.keys(t);for(e=0;e<i.length;e++)if(t[i[e]]!==this._animateTo[i[e]])return!0;return!1},a.prototype._shouldAnimate=function(t,e){var i,n,r,o=this,s=o._item;return!(o._element===s._element&&!s.isReleasing()&&!s.isDragging()&&!s._migrate.isActive)||(i=s.getGrid(),n={left:0,top:0,width:J,height:K},r={left:i._left+i._border.left+parseFloat(t.translateX),top:i._top+i._border.top+parseFloat(t.translateY),width:s._width+s._margin.left+s._margin.right,height:s._height+s._margin.top+s._margin.bottom},!!U.doRectsOverlap(n,r)||(r.left=i._left+i._border.left+parseFloat(e.translateX),r.top=i._top+i._border.top+parseFloat(e.translateY),U.doRectsOverlap(n,r)))},l.prototype.destroy=function(){var t=this;return t._isDestroyed||(t.stop(!0),t._isDestroyed=!0),t},l.prototype.getItem=function(){return ct[this._itemId]||null},l.prototype.start=function(t,e,i){var n,o,s,l,d,h,f,u,_,p,c,g,m=this;return m._isDestroyed?m:(n=m.getItem(),o=n._element,s=n.isVisible(),l=n.getGrid(),d=l._settings,h=t._settings,f=t._element,p=i||st,u=l._items.indexOf(n),null===(_=typeof e===dt?e:t._items.indexOf(t._getItem(e)))?m:(n.isPositioning()&&n._stopLayout(!0),m.isActive&&m.stop(!0),n.isReleasing()&&n._release.stop(!0),l._itemShowHandler.stop(n),l._itemHideHandler.stop(n),n._drag&&n._drag.destroy(),n._animate.destroy(),n._animateChild.destroy(),V(n._visibilityQueue,!0,n),l._emit("beforeSend",{item:n,fromGrid:l,fromIndex:u,toGrid:t,toIndex:_}),t._emit("beforeReceive",{item:n,fromGrid:l,fromIndex:u,toGrid:t,toIndex:_}),C(o,d.itemClass),C(o,d.itemVisibleClass),C(o,d.itemHiddenClass),I(o,h.itemClass),I(o,s?h.itemVisibleClass:h.itemHiddenClass),l._items.splice(u,1),y(t._items,n,_),n._gridId=t._id,n._animate=new r.ItemAnimate(n,o),n._animateChild=new r.ItemAnimate(n,n._child),n._isDefaultAnimate=n._animate instanceof a,c=o.parentNode,p!==c&&(p.appendChild(o),g=H(p,c,!0),b(o,{transform:"translateX("+(S(o,"x")+g.left)+"px) translateY("+(S(o,"y")+g.top)+"px)"})),b(o,{display:s?"block":"hidden"}),n._refreshDimensions()._refreshSortData(),n._child.removeAttribute("style"),s?t._itemShowHandler.start(n,!0):t._itemHideHandler.start(n,!0),n._drag=h.dragEnabled?new r.ItemDrag(n):null,g=H(p,f,!0),m.isActive=!0,m.container=p,m.containerDiffX=g.left,m.containerDiffY=g.top,l._emit("send",{item:n,fromGrid:l,fromIndex:u,toGrid:t,toIndex:_}),t._emit("receive",{item:n,fromGrid:l,fromIndex:u,toGrid:t,toIndex:_}),m))},l.prototype.stop=function(t){var e,i,n,r,o,s,a=this;return a._isDestroyed||!a.isActive?a:(e=a.getItem(),i=e._element,n=e.getGrid(),r=n._element,a.container!==r&&(o=t?S(i,"x")-a.containerDiffX:e._left,s=t?S(i,"y")-a.containerDiffY:e._top,r.appendChild(i),b(i,{transform:"translateX("+o+"px) translateY("+s+"px)"})),a.isActive=!1,a.container=null,a.containerDiffX=0,a.containerDiffY=0,a)},d.prototype.destroy=function(){var t=this;return t._isDestroyed||(t.stop(!0),t._isDestroyed=!0),t},d.prototype.getItem=function(){return ct[this._itemId]||null},d.prototype.reset=function(){var t,e=this;return e._isDestroyed||(t=e.getItem(),e.isActive=!1,e.isPositioningStarted=!1,e.containerDiffX=0,e.containerDiffY=0,C(t._element,t.getGrid()._settings.itemReleasingClass)),e},d.prototype.start=function(){var t,e,i=this;return i._isDestroyed||i.isActive?i:(t=i.getItem(),e=t.getGrid(),i.isActive=!0,I(t._element,e._settings.itemReleasingClass),e._emit("dragReleaseStart",t),J=Z.innerWidth,K=Z.innerHeight,t._layout(!1),i)},d.prototype.stop=function(t){var e,i,n,r,o,s,a,l,d=this;return d._isDestroyed||!d.isActive?d:(e=d.getItem(),i=e._element,n=e.getGrid(),r=n._element,o=d.containerDiffX,s=d.containerDiffY,d.reset(),i.parentNode!==r&&(a=t?S(i,"x")-o:e._left,l=t?S(i,"y")-s:e._top,r.appendChild(i),b(i,{transform:"translateX("+a+"px) translateY("+l+"px)"})),t||n._emit("dragReleaseEnd",e),d)},h.defaultStartPredicate=function(t,e,i){var n,r,o,s,a=t._element,l=t._drag._startPredicateData;if(l||(n=c(n=i||t._drag.getGrid()._settings.dragStartPredicate)?n:{},l=t._drag._startPredicateData={distance:et.abs(n.distance)||0,delay:et.max(n.delay,0)||0,handle:"string"==typeof n.handle&&n.handle}),e.isFinal)return r="a"===a.tagName.toLowerCase(),o=a.getAttribute("href"),s=a.getAttribute("target"),q(t),void(r&&o&&et.abs(e.deltaX)<2&&et.abs(e.deltaY)<2&&e.deltaTime<200&&(s&&"_self"!==s?Z.open(o,s):Z.location.href=o));if(!l.handleElement)if(l.handle){for(l.handleElement=e.srcEvent.target;l.handleElement&&!vt(l.handleElement,l.handle);)l.handleElement=l.handleElement!==a?l.handleElement.parentElement:null;if(!l.handleElement)return!1}else l.handleElement=a;return l.delay&&(l.event=e,l.delayTimer||(l.delayTimer=Z.setTimeout(function(){l.delay=0,j(t,l.event)&&(t._drag._resolveStartPredicate(l.event),q(t))},l.delay))),j(t,e)},h.defaultSortPredicate=function(t){var e,i,n,r,o,s=t._drag,a=s._data,l=s.getGrid(),d=l._settings.dragSortPredicate||{},h=d.threshold||50,f=d.action||"move",u={width:t._width,height:t._height,left:a.elementClientX,top:a.elementClientY},_=W(u,l,h),p=0,c=0,g=-1;if(!_)return!1;for(_===l?(u.left=a.gridX+t._margin.left,u.top=a.gridY+t._margin.top):(p=_._left+_._border.left,c=_._top+_._border.top),o=0;o<_._items.length;o++)(n=_._items[o])._isActive&&n!==t&&(i=!0,(r=P(u,{width:n._width,height:n._height,left:n._left+n._margin.left+p,top:n._top+n._margin.top+c}))>g&&(e=o,g=r));return g<h&&t.getGrid()!==_&&(e=i?-1:0,g=1/0),g>=h&&{grid:_,index:e,action:f}},h.prototype.destroy=function(){var t=this;return t._isDestroyed||(t.stop(),t._hammer.destroy(),t.getItem()._element.removeEventListener("dragstart",B,!1),t._isDestroyed=!0),t},h.prototype.getItem=function(){return ct[this._itemId]||null},h.prototype.getGrid=function(){return pt[this._gridId]||null},h.prototype.reset=function(){var t=this,e=t._data;return e.isActive=!1,e.container=null,e.containingBlock=null,e.startEvent=null,e.currentEvent=null,e.scrollers=[],e.left=0,e.top=0,e.gridX=0,e.gridY=0,e.elementClientX=0,e.elementClientY=0,e.containerDiffX=0,e.containerDiffY=0,t},h.prototype.bindScrollListeners=function(){var t,e=this,i=e.getGrid()._element,n=e._data.container,r=R(e.getItem()._element);for(n!==i&&(r=p(r.concat(i).concat(R(i)))),t=0;t<r.length;t++)r[t].addEventListener("scroll",e._scrollListener);return e._data.scrollers=r,e},h.prototype.unbindScrollListeners=function(){var t,e=this,i=e._data,n=i.scrollers;for(t=0;t<n.length;t++)n[t].removeEventListener("scroll",e._scrollListener);return i.scrollers=[],e},h.prototype.checkOverlap=function(){var t,e,i,n,r,o=this,s=o.getItem(),a=o._sortPredicate(s,o._data.currentEvent);return c(a)&&typeof a.index===dt?(t=s.getGrid(),e=t._items.indexOf(s),i=a.grid||t,n=f(t._items,a.index),r="swap"===a.action?"swap":"move",t===i?e!==n&&(("swap"===r?u:_)(t._items,e,n),t._emit("move",{item:s,fromIndex:e,toIndex:n,action:r}),t.layout()):(t._emit("beforeSend",{item:s,fromGrid:t,fromIndex:e,toGrid:i,toIndex:n}),i._emit("beforeReceive",{item:s,fromGrid:t,fromIndex:e,toGrid:i,toIndex:n}),s._gridId=i._id,o._isMigrating=s._gridId!==o._gridId,t._items.splice(e,1),y(i._items,s,n),s._sortData=null,t._emit("send",{item:s,fromGrid:t,fromIndex:e,toGrid:i,toIndex:n}),i._emit("receive",{item:s,fromGrid:t,fromIndex:e,toGrid:i,toIndex:n}),t.layout(),i.layout()),o):o},h.prototype.finishMigration=function(){var t,e,i,n=this,o=n.getItem(),s=o._release,l=o._element,d=o.getGrid(),h=d._element,f=d._settings,u=f.dragContainer||h,_=n.getGrid()._settings,p=l.parentNode;return n._isMigrating=!1,n.destroy(),o._animate.destroy(),o._animateChild.destroy(),C(l,_.itemClass),C(l,_.itemVisibleClass),C(l,_.itemHiddenClass),I(l,f.itemClass),I(l,f.itemVisibleClass),o._animate=new r.ItemAnimate(o,l),o._animateChild=new r.ItemAnimate(o,o._child),o._isDefaultAnimate=o._animate instanceof a,u!==p&&(u.appendChild(l),i=H(p,u,!0),t=S(l,"x")-i.left,e=S(l,"y")-i.top),o._refreshDimensions()._refreshSortData(),i=H(u,h,!0),s.containerDiffX=i.left,s.containerDiffY=i.top,o._drag=f.dragEnabled?new r.ItemDrag(o):null,u!==p&&b(l,{transform:"translateX("+t+"px) translateY("+e+"px)"}),o._child.removeAttribute("style"),d._itemShowHandler.start(o,!0),s.start(),n},h.prototype.stop=function(){var t,e,i=this,n=i._data;return n.isActive?i._isMigrating?i.finishMigration(n.currentEvent):(t=i.getItem()._element,e=i.getGrid(),i.unbindScrollListeners(),i._checkSortOverlap("cancel"),t.parentNode!==e._element&&(e._element.appendChild(t),b(t,{transform:"translateX("+n.gridX+"px) translateY("+n.gridY+"px)"})),C(t,e._settings.itemDraggingClass),i.reset(),i):i},h.prototype.onStart=function(t){var e,i,n,r,o,s,a,l,d,h,f,u,_=this,p=_.getItem();if(p._isActive)return e=p._element,i=_.getGrid(),n=i._settings,r=_._data,o=p._release,p.isPositioning()&&p._stopLayout(!0),p._migrate.isActive&&p._migrate.stop(!0),p.isReleasing()&&o.reset(),r.isActive=!0,r.startEvent=r.currentEvent=t,s=S(e,"x"),a=S(e,"y"),l=i._element,r.container=d=n.dragContainer||l,r.containingBlock=h=G(d,!0),r.left=r.gridX=s,r.top=r.gridY=a,i._emit("dragInit",p,t),d!==l&&(f=H(h,l),r.containerDiffX=f.left,r.containerDiffY=f.top,e.parentNode===d?(r.gridX=s-r.containerDiffX,r.gridY=a-r.containerDiffY):(r.left=s+r.containerDiffX,r.top=a+r.containerDiffY,d.appendChild(e),b(e,{transform:"translateX("+r.left+"px) translateY("+r.top+"px)"}))),I(e,n.itemDraggingClass),_.bindScrollListeners(),u=e.getBoundingClientRect(),r.elementClientX=u.left,r.elementClientY=u.top,i._emit("dragStart",p,t),_},h.prototype.onMove=function(t){var e,i,n,r,o,s,a,l=this,d=l.getItem();if(d._isActive)return e=d._element,i=l.getGrid(),n=i._settings,r=l._data,a=n.dragAxis,o=t.deltaX-r.currentEvent.deltaX,s=t.deltaY-r.currentEvent.deltaY,r.currentEvent=t,"y"!==a&&(r.left+=o,r.gridX+=o,r.elementClientX+=o),"x"!==a&&(r.top+=s,r.gridY+=s,r.elementClientY+=s),n.dragSort&&l._checkSortOverlap(),b(e,{transform:"translateX("+r.left+"px) translateY("+r.top+"px)"}),i._emit("dragMove",d,t),l;l.stop()},h.prototype.onScroll=function(t){var e,i=this,n=i.getItem(),r=n._element,o=i.getGrid(),s=o._settings,a=s.dragAxis,l=i._data,d=o._element,h=r.getBoundingClientRect(),f=l.elementClientX-h.left,u=l.elementClientY-h.top;return l.container!==d&&(e=H(l.containingBlock,d),l.containerDiffX=e.left,l.containerDiffY=e.top),"y"!==a&&(l.left+=f,l.gridX=l.left-l.containerDiffX),"x"!==a&&(l.top+=u,l.gridY=l.top-l.containerDiffY),s.dragSort&&i._checkSortOverlap(),b(r,{transform:"translateX("+l.left+"px) translateY("+l.top+"px)"}),o._emit("dragScroll",n,t),i},h.prototype.onEnd=function(t){var e=this,i=e.getItem(),n=i._element,r=e.getGrid(),o=r._settings,s=e._data,a=i._release;return i._isActive?(o.dragSort&&e._checkSortOverlap("finish"),e.unbindScrollListeners(),a.containerDiffX=s.containerDiffX,a.containerDiffY=s.containerDiffY,e.reset(),C(n,o.itemDraggingClass),r._emit("dragEnd",i,t),e._isMigrating?e.finishMigration():a.start(),e):e.stop()},U.getSlot=function(t,e,i,n,r,o){var s,a,l,d,h,f=[],u={left:null,top:null,width:i,height:n};for(d=0;d<e.length;d++)if(s=e[d],u.width<=s.width+.001&&u.height<=s.height+.001){u.left=s.left,u.top=s.top;break}for(null===u.left&&(u.left=r?0:t.width,u.top=r?t.height:0,o||(l=!0)),r&&u.top+u.height>t.height&&(u.left>0&&f.push({left:0,top:t.height,width:u.left,height:1/0}),u.left+u.width<t.width&&f.push({left:u.left+u.width,top:t.height,width:t.width-u.left-u.width,height:1/0}),t.height=u.top+u.height),!r&&u.left+u.width>t.width&&(u.top>0&&f.push({left:t.width,top:0,width:1/0,height:u.top}),u.top+u.height<t.height&&f.push({left:t.width,top:u.top+u.height,width:1/0,height:t.height-u.top-u.height}),t.width=u.left+u.width),d=o?0:l?e.length:d;d<e.length;d++)for(a=U.splitRect(e[d],u),h=0;h<a.length;h++)(s=a[h]).width>.49&&s.height>.49&&(r&&s.top<t.height||!r&&s.left<t.width)&&f.push(s);return f.length&&(f=U.purgeRects(f).sort(r?U.sortRectsTopLeft:U.sortRectsLeftTop)),[u,f]},U.splitRect=function(t,e){var i=[];return U.doRectsOverlap(t,e)?(t.left<e.left&&i.push({left:t.left,top:t.top,width:e.left-t.left,height:t.height}),t.left+t.width>e.left+e.width&&i.push({left:e.left+e.width,top:t.top,width:t.left+t.width-(e.left+e.width),height:t.height}),t.top<e.top&&i.push({left:t.left,top:t.top,width:t.width,height:e.top-t.top}),t.top+t.height>e.top+e.height&&i.push({left:t.left,top:e.top+e.height,width:t.width,height:t.top+t.height-(e.top+e.height)}),i):[{left:t.left,top:t.top,width:t.width,height:t.height}]},U.doRectsOverlap=function(t,e){return!(t.left+t.width<=e.left||e.left+e.width<=t.left||t.top+t.height<=e.top||e.top+e.height<=t.top)},U.isRectWithinRect=function(t,e){return t.left>=e.left&&t.top>=e.top&&t.left+t.width<=e.left+e.width&&t.top+t.height<=e.top+e.height},U.purgeRects=function(t){for(var e,i,n,r=t.length;r--;)for(i=t[r],e=t.length;e--;)if(n=t[e],r!==e&&U.isRectWithinRect(i,n)){t.splice(r,1);break}return t},U.sortRectsTopLeft=function(t,e){return t.top-e.top||t.left-e.left},U.sortRectsLeftTop=function(t,e){return t.left-e.left||t.top-e.top},r});