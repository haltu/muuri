/*!
 * Muuri v0.2.0
 * https://github.com/haltu/muuri
 * Copyright (c) 2015, Haltu Oy
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
!function(t,e){var i="Muuri",n="function"==typeof jQuery?jQuery.Velocity:t.Velocity,r=t.Hammer;t[i]=e(t,n,r)}(this,function(t,e,n,r){"use strict";function o(){}function s(t){var e=this,i=[],n=!!t.fillGaps,r=!!t.horizontal,o=!!t.alignRight,a=!!t.alignBottom;if(e.width=Math.round(e.width),e.height=Math.round(e.height),r?(e.setWidth=!0,e.width=0):(e.setHeight=!0,e.height=0),e.items.length){for(var l=0;l<e.items.length;l++){var h=e.items[l],u=s.getSlot(e,i,h._width,h._height,!r,n);r?e.width=Math.max(e.width,u.left+u.width):e.height=Math.max(e.height,u.top+u.height),e.slots[h._id]=u}if(o||a)for(var f in e.slots){var u=e.slots[f];o&&(u.left=e.width-(u.left+u.width)),a&&(u.top=e.height-(u.top+u.height))}}}function a(e){var i=this,n=i._settings=m({},a.defaultSettings,e||{});if(!document.body.contains(n.container))throw new Error("Container must be an existing DOM element");i._element=n.container,y(n.container,n.containerClass),i._id=++k,i._animQueue="muuri-"+i._id,i._emitter=new o,i._itemShow="function"==typeof n.show?n.show():M(n.show,!0),i._itemHide="function"==typeof n.hide?n.hide():M(n.hide),i._items=[];for(var r=0,s=n.items.length;r<s;r++)i._items[i._items.length]=new a.Item(i,n.items[r]);if(n.layoutOnResize||0===n.layoutOnResize){var l=d(function(){i.refresh(),i.layout()},n.layoutOnResize);i._resizeHandler=function(){l()},t.addEventListener("resize",i._resizeHandler)}n.layoutOnInit&&i.layout(!0)}function l(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function h(t,e,i){t.splice(i,0,t.splice(e,1)[0])}function u(t){for(var e=[],i=0,n=t.length;i<n;i++)e.indexOf(t[i])===-1&&(e[e.length]=t[i]);return e}function f(t){return"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)}function m(t){for(var e=Array.prototype.slice.call(arguments,1),i=0;i<e.length;i++){var n=e[i];for(var r in n)n.hasOwnProperty(r)&&(f(t[r])&&f(n[r])?m(t[r],n[r]):t[r]=n[r])}return t}function d(e,i){var n,o="cancel",s="finish";return function(a){n!==r&&(n=t.clearTimeout(n),a===s&&e()),a!==o&&a!==s&&(n=t.setTimeout(function(){n=r,e()},i))}}function c(t,e){var i=null,n={left:t.left-e.left,right:e.left+e.width-(t.left+t.width),top:t.top-e.top,bottom:e.top+e.height-(t.top+t.height)},r=Math.max(t.width+Math.min(n.left,0)+Math.min(n.right,0),0),o=Math.max(t.height+Math.min(n.top,0)+Math.min(n.bottom,0),0),s=r>0&&o>0;return s&&(i={},i.width=r,i.height=o,i.left=t.left+Math.abs(Math.min(n.left,0)),i.right=i.left+i.width,i.top=t.top+Math.abs(Math.min(n.top,0)),i.bottom=i.top+i.height),i}function _(e,i){return t.getComputedStyle(e,null).getPropertyValue(i)}function g(t,e){for(var i in e)t.style[i]=e[i]}function p(t,i){for(var n in i)e.hook(t,n,i[n])}function v(t,e){return(" "+t.className).indexOf(" "+e)>-1}function y(t,e){t.classList?t.classList.add(e):v(t,e)&&(t.className+=" "+e)}function w(t,e){t.classList?t.classList.remove(e):v(t,e)&&(t.className=(" "+t.className+" ").replace(" "+e+" "," ").trim())}function C(e,i,n){var o=e.getBoundingClientRect()[i],s="height"===i,a=s?"Height":"Width",l="inner"+a,h="client"+a,u=s?"top":"left",f=s?"bottom":"right";if(n){var m=parseFloat(_(e,"margin-"+u)),d=parseFloat(_(e,"margin-"+f));o+=m>0?m:0,o+=d>0?d:0}else{var c,g;e===document.documentElement?o-=t[l]-document.documentElement[h]:(c=parseFloat(_(e,"border-"+u+"-width")),g=parseFloat(_(e,"border-"+f+"-width")),o-=Math.round(o)-e[h]-c-g),o-=c!==r?c:parseFloat(_(e,"border-"+u+"-width")),o-=g!==r?g:parseFloat(_(e,"border-"+f+"-width"))}return o}function b(e){var i=0,n=0,r=parseFloat(t.pageXOffset),o=parseFloat(t.pageYOffset);if(e.self===t.self)i=r,n=o;else if(e!==document){var s=e.getBoundingClientRect();i+=s.left+r+parseFloat(_(e,"border-left-width")),n+=s.top+o+parseFloat(_(e,"border-top-width"))}return{left:i,top:n}}function D(e){var i="fixed"===_(e,"position");if(i&&rt)return t;var n=e===document.documentElement||e===t?document:e.parentElement||null;if(i){for(;n&&n!==document&&!x(n);)n=n.parentElement||document;return n===document?t:n}for(;n&&n!==document&&"static"===_(n,"position")&&!x(n);)n=n.parentElement||document;return n}function x(t){var e=_(t,nt.style),i=_(t,"display");return"none"!==e&&"inline"!==i&&"none"!==i}function S(t,e){var i=b(e),n=b(D(t)||doc);return n.left-=Math.abs(Math.min(parseFloat(_(t,"margin-left")),0)),n.top-=Math.abs(Math.min(parseFloat(_(t,"margin-top")),0)),{left:i.left-n.left,top:i.top-n.top}}function R(e){var i=[],n=/(auto|scroll)/,r=e.parentNode;if(rt){if("fixed"===_(e,"position"))return i;for(;r&&r!==document&&r!==document.documentElement;)n.test(_(r,"overflow")+_(r,"overflow-y")+_(r,"overflow-x"))&&(i[i.length]=r),r="fixed"===_(r,"position")?null:r.parentNode;null!==r&&(i[i.length]=t)}else{for(;r&&r!==document;)"fixed"!==_(e,"position")||x(r)?(n.test(_(r,"overflow")+_(r,"overflow-y")+_(r,"overflow-x"))&&(i[i.length]=r),e=r,r=r.parentNode):r=r.parentNode;i.length&&i[i.length-1]===document.documentElement&&(i[i.length-1]=t)}return i}function I(t,e){var i=c(t,e);if(!i)return 0;var n={width:t.width,height:t.height,left:0,top:0},r={width:e.width,height:e.height,left:0,top:0},o=c(n,r);return i.width*i.height/(o.width*o.height)*100}function O(t,e,i){return{type:t,event:e,currentLeft:i.left,currentTop:i.top,gridLeft:i.gridX,gridTop:i.gridY}}function X(t,e,i){this.isResolved||(this.isResolved=!0,i(t))}function Y(t){if(!t.elementStyles){var e=["width","height","padding","margin"];t.elementStyles={};for(var i=0;i<4;i++){var n=e[i],r=t.element.style[n];t.elementStyles[n]=r||""}for(var i=0;i<4;i++){var n=e[i];t.element.style[n]=_(t.element,n)}}}function L(t){if(t.elementStyles)for(var e in t.elementStyles)t.element.style[e]=t.elementStyles[e]}function E(t,e,i,n,r){i=t.get(i),r="function"==typeof n?n:r;var o=i.length;if(o){var s="show"===e,a=s?A:W,l=s?j:B,h=n===!0,u=[],f=!1,m=[];t._emitter.emit(a,i);for(var d=0,c=i.length;d<c;d++){var _=i[d];(s&&!_._active||!s&&_._active)&&(f=!0,s&&(_._noLayoutAnimation=!0,m[m.length]=_)),_["_"+e](h,function(e,i){e||(u[u.length]=i),--o<1&&("function"==typeof r&&r(u),t._emitter.emit(l,u))})}f&&(m.length&&t.refresh(m),t.layout())}else"function"==typeof r&&r(i)}function M(t,i){var n=t&&t.duration||0,r=t&&t.easing||"ease-out";if(n){var o=i?{opacity:1,scale:1}:{opacity:0,scale:.5};return{start:function(t,i,s){i?p(t._child,o):(e(t._child,o,{duration:n,easing:r,queue:t._muuri._animQueue,complete:s}),e.Utilities.dequeue(t._child,t._muuri._animQueue))},stop:function(t){e(t._child,"stop",t._muuri._animQueue)}}}return{start:P,stop:P}}function Q(t,e,i){for(var n=t.splice(0,t.length),r=0,o=n.length;r<o;r++)n[r](e,i)}if(!document.body)throw Error("Muuri needs access to document.body to work.");var k=0,P=function(){},F="function"==typeof t.requestAnimationFrame?t.requestAnimationFrame:null,H="refresh",N="synchronize",T="layoutstart",z="layoutend",A="showstart",j="showend",W="hidestart",B="hideend",q="move",V="swap",U="add",G="remove",Z="dragstart",J="dragmove",K="dragscroll",$="dragend",tt="releasestart",et="releaseend",it="destroy",nt=function(){for(var t=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],e=0;e<t.length;e++)if(document.documentElement.style[t[e]]!==r){var i=t[e],n=i.toLowerCase().split("transform")[0];return{prefix:n,prop:i,style:n?"-"+n+"-transform":i}}return null}(),rt=function(){if(!nt)return!0;var t,e,i=document.body,n=document.createElement("div"),r=document.createElement("div");return g(n,{display:"block",visibility:"hidden",position:"absolute",width:"1px",height:"1px",left:"1px",top:"0",margin:"0"}),g(r,{display:"block",position:"fixed",width:"1px",height:"1px",left:"0",top:"0",margin:"0"}),n.appendChild(r),i.appendChild(n),t=r.getBoundingClientRect().left,n.style[nt.prop]="translateZ(0)",e=r.getBoundingClientRect().left,i.removeChild(n),e===t}();return o.prototype.on=function(t,e){var i=this._events=this._events||{},n=i[t]||[];return n[n.length]=e,i[t]=n,this},o.prototype.off=function(t,e){var n=this._events=this._events||{},r=n[t]||[],o=r.length;if(o)for(;o--;)e===r[i]&&r.splice(o,1);return this},o.prototype.emit=function(t,e,i,n){var r=this._events=this._events||{},o=r[t]||[],s=o.length;if(s){var a=arguments.length-1;o=o.concat();for(var l=0;l<s;l++)0===a?o[l]():1===a?o[l](e):2===a?o[l](e,i):o[l](e,i,n)}return this},s.getSlot=function(t,e,i,n,r,o){var a,l,h,u,f,m=e[0]||[],d=[],c={left:null,top:null,width:i,height:n};for(a=0;a<m.length;a++)if(h=m[a],c.width<=h.width&&c.height<=h.height){c.left=h.left,c.top=h.top;break}for(null===c.left&&(c.left=r?0:t.width,c.top=r?t.height:0,o||(f=!0)),r&&c.top+c.height>t.height&&(c.left>0&&(d[d.length]={left:0,top:t.height,width:c.left,height:1/0}),c.left+c.width<t.width&&(d[d.length]={left:c.left+c.width,top:t.height,width:t.width-c.left-c.width,height:1/0}),t.height=c.top+c.height),!r&&c.left+c.width>t.width&&(c.top>0&&(d[d.length]={left:t.width,top:0,width:1/0,height:c.top}),c.top+c.height<t.height&&(d[d.length]={left:t.width,top:c.top+c.height,width:1/0,height:t.height-c.top-c.height}),t.width=c.left+c.width),a=o?0:f?m.length:a;a<m.length;a++)for(u=s.splitRect(m[a],c),l=0;l<u.length;l++)h=u[l],h.width>0&&h.height>0&&(r&&h.top<t.height||!r&&h.left<t.width)&&(d[d.length]=h);return s.purgeSlots(d).sort(r?s.sortRectsTopLeft:s.sortRectsLeftTop),e[0]=d,c},s.sortRectsTopLeft=function(t,e){return t.top<e.top?-1:t.top>e.top?1:t.left<e.left?-1:t.left>e.left?1:0},s.sortRectsLeftTop=function(t,e){return t.left<e.left?-1:t.left>e.left?1:t.top<e.top?-1:t.top>e.top?1:0},s.isRectWithinRect=function(t,e){return t.left>=e.left&&t.top>=e.top&&t.left+t.width<=e.left+e.width&&t.top+t.height<=e.top+e.height},s.purgeSlots=function(t){for(var e=t.length;e--;)for(var i=t[e],n=t.length;n--;){var r=t[n];if(e!==n&&s.isRectWithinRect(i,r)){t.splice(e,1);break}}return t},s.splitRect=function(t,e){var i=[],n=!(e.left>t.left+t.width||e.left+e.width<t.left||e.top>t.top+t.height||e.top+e.height<t.top);return n?(t.left<e.left&&(i[i.length]={left:t.left,top:t.top,width:e.left-t.left,height:t.height}),t.left+t.width>e.left+e.width&&(i[i.length]={left:e.left+e.width,top:t.top,width:t.left+t.width-(e.left+e.width),height:t.height}),t.top<e.top&&(i[i.length]={left:t.left,top:t.top,width:t.width,height:e.top-t.top}),t.top+t.height>e.top+e.height&&(i[i.length]={left:t.left,top:e.top+e.height,width:t.width,height:t.top+t.height-(e.top+e.height)})):i[0]=t,i},a.prototype._getItem=function(t){if(t){if(t instanceof a.Item)return t._muuri===this?t:null;if("number"==typeof t)return t=t>-1?t:this._items.length+t,this._items[t]||null;for(var e=null,i=0,n=this._items.length;i<n;i++){var r=this._items[i];if(r._element===t){e=r;break}}return e}return this._items[0]||null},a.prototype.on=function(t,e){return this._emitter.on(t,e),this},a.prototype.off=function(t,e){return this._emitter.off(t,e),this},a.prototype.refresh=function(t){t=t?this.get(t):this.get("active");for(var e=0,i=t.length;e<i;e++)t[e]._refresh();this._emitter.emit(H,t)},a.prototype.get=function(t,e){var i=t&&"string"!=typeof t;if(e=i?e:t,e="string"==typeof e?e:null,t=i?[].concat(t):null,e||t){for(var n=t||this._items,r=[],o="active"===e,s="inactive"===e,a=0,l=n.length;a<l;a++){var h=i?this._getItem(n[a]):n[a];h&&(!e||o&&h._active||s&&!h._active)&&(r[r.length]=h)}return r}return this._items.concat()},a.prototype.add=function(t,e){var i=[],n=!1;t=[].concat(t);for(var r=0,o=this._items.length;r<o;r++){var s=this._items[r],e=t.indexOf(s._element);e>-1&&t.splice(e,1)}if(!t.length)return i;for(var r=0,o=t.length;r<o;r++){var s=new a.Item(this,t[r]);i[i.length]=s,s._active&&(n=!0,s._noLayoutAnimation=!0)}return e=e<0?this._items.length-e+1:e,this._items.splice.apply(this._items,[e,0].concat(i)),n&&this.layout(),this._emitter.emit(U,i),i},a.prototype.remove=function(t,e){var i=[],n=!1;t=this.get(t);for(var r=0,o=t.length;r<o;r++){var s=t[r];s._active&&(n=!0),i[i.length]=s._destroy(e)}return n&&this.layout(),this._emitter.emit(G,i),i},a.prototype.synchronize=function(){for(var t=0,e=this._items.length;t<e;t++){var i=this._items[t];i._element.parentNode===this._element&&this._element.appendChild(i._element)}this._emitter.emit(N)},a.prototype.layout=function(t,e){var i=this,n=i._emitter,e="function"==typeof t?t:e,r=t===!0,o=new a.Layout(i),s=-1,l=o.items.length,h=[],u=function(t,i){t||(h[h.length]=i),++s===l&&("function"==typeof e&&e(h,o),n.emit(z,h,o))};if(n.emit(T,o.items,o),o.setHeight&&g(i._element,{height:o.height+"px"}),o.setWidth&&g(i._element,{width:o.width+"px"}),l)for(var f=0,m=o.items.length;f<m;f++){var d=o.items[f],c=o.slots[d._id];d._left=c.left,d._top=c.top,d._drag.active?u(!1,d):d._layout(r,u)}else u(!0)},a.prototype.show=function(t,e,i){E(this,"show",t,e,i)},a.prototype.hide=function(t,e,i){E(this,"hide",t,e,i)},a.prototype.indexOf=function(t){if("number"==typeof t)return t<=this._items.length-1?t:null;if(t instanceof a.Item){var e=this._items.indexOf(t);return e>-1?e:null}for(var e=null,i=0,n=this._items.length;i<n;i++)if(this._items[i]._element===t){e=i;break}return e},a.prototype.move=function(t,e){t=this._getItem(t),e=this._getItem(e),t&&e&&t!==e&&(h(this._items,this._items.indexOf(t),this._items.indexOf(e)),this._emitter.emit(q,t,e))},a.prototype.swap=function(t,e){t=this._getItem(t),e=this._getItem(e),t&&e&&t!==e&&(l(this._items,this._items.indexOf(t),this._items.indexOf(e)),this._emitter.emit(V,t,e))},a.prototype.destroy=function(){this._resizeHandler&&t.removeEventListener("resize",this._resizeHandler);for(var e=this._items.concat(),i=0,n=e.length;i<n;i++)e[i]._destroy();w(this._element,this._settings.containerClass),g(this._element,{height:""}),this._emitter.emit(it);var r=this._emitter._events;if(r)for(var o=Object.keys(this._emitter._events),i=0,n=o.length;i<n;i++)r[o[i]].length=0;for(var s=Object.keys(this).concat(Object.keys(a.prototype)),i=0;i<s.length;i++)this[s[i]]=null},a.Item=function(t,e){if(e.contains(t._element))throw new Error("Item element must not be a parent of the grid container element");e.parentNode!==t._element&&t._element.appendChild(e);var i=t._settings,n="none"===_(e,"display");this._id=++k,this._muuri=t,this._element=e,this._child=e.children[0],y(e,i.itemClass),this._active=!n,this._positioning=!1,this._hidden=n,this._hiding=!1,this._showing=!1,this._visibiliyQueue=[],this._layoutQueue=[],p(this._element,{left:"0",top:"0",translateX:"0px",translateY:"0px"}),y(e,n?i.hiddenClass:i.shownClass),p(this._child,{scale:n?0:1,opacity:n?0:1}),n||g(this._element,{display:"block"}),this._refresh(),this._left=0,this._top=0,this._drag={active:!1},this._release={active:!1},t._settings.dragEnabled&&this._initDrag()},a.Item.prototype.inspect=function(){return{element:this._element,width:this._width,height:this._height,left:this._left,top:this._top,active:this._active,positioning:this._positioning,dragging:this._drag.active,releasing:this._release.active,visibility:this._hiding?"hiding":this._showing?"showing":this._hidden?"hidden":"shown"}},a.Item.prototype._initDrag=function(){var t=this,e=t._muuri._settings,i=t._hammer=new n.Manager(t._element);i.add(new n.Pan({event:"drag",pointers:1,threshold:0,direction:n.DIRECTION_ALL})),i.add(new n.Press({event:"draginit",pointers:1,threshold:100,time:0})),i.set({touchAction:"none"}),t._resetReleaseData();var r=t._drag;t._resetDragData(),r.checkOverlap=d(function(){r.active&&t._checkOverlap()},e.dragSortInterval);var o=!1;r.predicate="function"==typeof e.dragPredicate?e.dragPredicate:X,r.predicateData={},r.isPredicateResolved=function(){return o},r.resolvePredicate=function(e){o||"draginitup"===e.type||"dragend"===e.type||"dragcancel"===e.type||(o=!0,t._onDragStart(e))},r.onScroll=function(e){F?F(function(){t._onDragScroll(e)}):t._onDragScroll(e)},i.on("draginit",function(e){r.predicateData={},o=!1,r.predicate.call(r.predicateData,e,t,r.resolvePredicate)}).on("dragstart dragmove",function(e){o&&r.active&&t._onDragMove(e),r.predicate.call(r.predicateData,e,t,r.resolvePredicate)}).on("dragend dragcancel draginitup",function(e){o&&r.active&&t._onDragEnd(e),r.predicate.call(r.predicateData,e,t,r.resolvePredicate)})},a.Item.prototype._resetDragData=function(){var t=this._drag;t.active=!1,t.start=null,t.move=null,t.element=null,t.elemWidth=0,t.elemHeight=0,t.elementStyles=null,t.scrollParents=[],t.left=0,t.top=0,t.gridX=0,t.gridY=0,t.elemClientX=0,t.elemClientY=0,t.containerDiffX=0,t.containerDiffY=0},a.Item.prototype._onDragStart=function(t){var i=this._drag,n=this._muuri._settings,r=this._release.active;if(this._active){this._positioning&&this._stopLayout(),r&&(i.elementStyles=this._release.elementStyles,w(this._element,n.releasingClass),this._resetReleaseData()),i.active=!0,i.start=t,i.move=t,i.element=this._element,i.elemWidth=this._width,i.elemHeight=this._height;var o=parseFloat(e.hook(i.element,"translateX"))||0,s=parseFloat(e.hook(i.element,"translateY"))||0,a=this._muuri._element,l=n.dragContainer;if(i.left=i.gridX=o,i.top=i.gridY=s,l&&l!==a)if(i.element.parentNode===l){var h=S(i.element,a);i.containerDiffX=h.left,i.containerDiffY=h.top,i.gridX=o-i.containerDiffX,i.gridY=s-i.containerDiffY}else{Y(i),l.appendChild(i.element);var h=S(i.element,a);i.containerDiffX=h.left,i.containerDiffY=h.top,i.left=o+i.containerDiffX,i.top=s+i.containerDiffY,p(i.element,{translateX:i.left+"px",translateY:i.top+"px"})}var f=i.element.getBoundingClientRect();i.elemClientX=f.left,i.elemClientY=f.top,i.scrollParents=R(i.element),l&&l!==a&&(i.scrollParents=u(i.scrollParents.concat(R(a))));for(var m=0,d=i.scrollParents.length;m<d;m++)i.scrollParents[m].addEventListener("scroll",i.onScroll);y(i.element,n.draggingClass),this._muuri._emitter.emit(Z,this,O("dragstart",t,i))}},a.Item.prototype._onDragMove=function(t){var e=this._drag,i=this._muuri._settings;if(!this._active)return void this._resetDrag();var n=t.deltaX-e.move.deltaX,r=t.deltaY-e.move.deltaY;e.move=t,e.left+=n,e.top+=r,e.gridX+=n,e.gridY+=r,e.elemClientX+=n,e.elemClientY+=r,p(e.element,{translateX:e.left+"px",translateY:e.top+"px"}),i.dragSort&&e.checkOverlap(),this._muuri._emitter.emit(J,this,O("dragmove",t,e))},a.Item.prototype._onDragScroll=function(t){var e=this._drag,i=this._muuri._settings,n=this._muuri._element,r=i.dragContainer,o=e.element.getBoundingClientRect(),s=e.elemClientX-o.left,a=e.elemClientY-o.top;if(r&&r!==n){var l=S(e.element,n);e.containerDiffX=l.left,e.containerDiffY=l.top}e.left+=s,e.top+=a,e.gridX=e.left-e.containerDiffX,e.gridY=e.top-e.containerDiffY,p(e.element,{translateX:e.left+"px",translateY:e.top+"px"}),i.dragSort&&e.checkOverlap(),this._muuri._emitter.emit(K,this,O("dragscroll",t,e))},a.Item.prototype._onDragEnd=function(t){var e=this._drag,i=this._muuri._settings,n=this._release;if(!this._active)return void this._resetDrag();i.dragSort&&e.checkOverlap("finish");for(var r=0,o=e.scrollParents.length;r<o;r++)e.scrollParents[r].removeEventListener("scroll",e.onScroll);w(e.element,i.draggingClass),e.active=!1,this._muuri._emitter.emit($,this,O("dragend",t,e)),n.containerDiffX=e.containerDiffX,n.containerDiffY=e.containerDiffY,n.element=e.element,n.elementStyles=e.elementStyles,this._resetDragData(),this._startRelease()},a.Item.prototype._resetDrag=function(t){for(var e=this._drag,i=this._muuri._settings,n=0,r=e.scrollParents.length;n<r;n++)e.scrollParents[n].removeEventListener("scroll",e.onScroll);e.checkOverlap("cancel"),w(e.element,i.draggingClass),L(e),this._resetDragData()},a.Item.prototype._resetReleaseData=function(){var t=this._release;t.active=!1,t.positioningStarted=!1,t.containerDiffX=0,t.containerDiffY=0,t.element=null,t.elementStyles=null},a.Item.prototype._startRelease=function(){var t=this._muuri._settings,e=this._release;e.active=!0,y(e.element,t.releasingClass),this._muuri._emitter.emit(tt,this),this._layout(!1)},a.Item.prototype._endRelease=function(){var t=this._muuri._settings,e=this._release;w(e.element,t.releasingClass),e.element.parentNode!==this._muuri._element&&(this._muuri._element.appendChild(e.element),p(e.element,{translateX:this._left+"px",translateY:this._top+"px"})),L(e),this._resetReleaseData(),this._muuri._emitter.emit(et,this)},a.Item.prototype._checkOverlap=function(){for(var t=this._muuri._settings,e=t.dragSortTolerance,i=t.dragSortAction,n=this._muuri._items,r=null,o=0,s={width:this._drag.elemWidth,height:this._drag.elemHeight,left:this._drag.gridX,top:this._drag.gridY},a=0,u=n.length;a<u;a++){var f=n[a];if(f===this)o=a;else if(f._active){var m=I(s,{width:f._width,height:f._height,left:f._left,top:f._top});(!r||m>r.score)&&(r={item:f,score:m,index:a})}}r&&r.score>=e&&("swap"===i?(l(n,o,r.index),this._muuri._emitter.emit(V,this,r.item)):(h(n,o,r.index),this._muuri._emitter.emit(q,this,r.item)),this._muuri.layout())},a.Item.prototype._stopLayout=function(){var t=this._muuri._settings;this._positioning&&(e(this._element,"stop",this._muuri._animQueue),w(this._element,t.positioningClass),this._positioning=!1,Q(this._layoutQueue,!0,this))},a.Item.prototype._refresh=function(){this._hidden||(this._width=Math.round(C(this._element,"width",!0)),this._height=Math.round(C(this._element,"height",!0)))},a.Item.prototype._layout=function(t,i){var n=this,r=n._muuri._settings,o=n._release,s=o.active&&o.positioningStarted===!1,a=s?r.dragReleaseDuration:r.positionDuration,l=s?r.dragReleaseEasing:r.positionEasing,h=t!==!0&&!n._noLayoutAnimation&&a>0,u=n._positioning,f=function(){w(n._element,r.positioningClass),n._positioning=!1,o.active&&n._endRelease(),Q(n._layoutQueue,!1,n)};n._stopLayout(),"function"==typeof i&&(n._layoutQueue[n._layoutQueue.length]=i),s&&(o.positioningStarted=!0);var m=n._release.active?n._release.containerDiffX:0,d=n._release.active?n._release.containerDiffY:0;if(h){var c=(parseFloat(e.hook(n._element,"translateX"))||0)-m,_=(parseFloat(e.hook(n._element,"translateY"))||0)-d;if(n._left===c&&n._top===_)return void f();n._positioning=!0,u||y(n._element,r.positioningClass),e(n._element,{translateX:n._left+m,translateY:n._top+d},{duration:a,easing:l,complete:f,queue:n._muuri._animQueue}),e.Utilities.dequeue(n._element,n._muuri._animQueue)}else n._noLayoutAnimation&&(n._noLayoutAnimation=!1),p(n._element,{translateX:n._left+m+"px",translateY:n._top+d+"px"}),f()},a.Item.prototype._show=function(t,e){var i=this,n=i._muuri._settings;if(i._hidden||i._showing)if(i._hidden){i._hiding;i._muuri._itemHide.stop(i),i._active=!0,i._hidden=!1,i._showing=i._hiding=!1,y(i._element,n.shownClass),w(i._element,n.hiddenClass),g(i._element,{display:"block"}),Q(i._visibiliyQueue,!0,i),i._showing=!0,"function"==typeof e&&(i._visibiliyQueue[i._visibiliyQueue.length]=e),i._muuri._itemShow.start(i,t,function(){Q(i._visibiliyQueue,!1,i)})}else"function"==typeof e&&(i._visibiliyQueue[i._visibiliyQueue.length]=e);else"function"==typeof e&&e(!1,i)},a.Item.prototype._hide=function(t,e){var i=this,n=i._muuri._settings;if(i._hidden&&!i._hiding)"function"==typeof e&&e(!1,i);else if(i._hidden)"function"==typeof e&&(i._visibiliyQueue[i._visibiliyQueue.length]=e);else{i._showing;i._muuri._itemShow.stop(i),i._active=!1,i._hidden=!0,i._showing=i._hiding=!1,y(i._element,n.hiddenClass),w(i._element,n.shownClass),Q(i._visibiliyQueue,!0,i),i._hiding=!0,"function"==typeof e&&(i._visibiliyQueue[i._visibiliyQueue.length]=e),i._muuri._itemHide.start(i,t,function(){g(i._element,{display:"none"}),Q(i._visibiliyQueue,!1,i)})}},a.Item.prototype._destroy=function(t){var e=(this._muuri,this._muuri._settings),i=this._element,n=this._muuri._items.indexOf(this);this._stopLayout(),this._muuri._itemShow.stop(this),this._muuri._itemHide.stop(this),this._release.active&&(i.parentNode!==this._muuri._element&&this._muuri._element.appendChild(i),this._resetReleaseData()),this._drag.active&&(i.parentNode!==this._muuri._element&&this._muuri._element.appendChild(i),this._resetDrag()),this._hammer&&this._hammer.destroy(),i.removeAttribute("style"),this._child.removeAttribute("style"),Q(this._visibiliyQueue,!0,this),w(i,e.positioningClass),w(i,e.draggingClass),w(i,e.releasingClass),w(i,e.itemClass),w(i,e.shownClass),w(i,e.hiddenClass),n>-1&&this._muuri._items.splice(n,1),t&&i.parentNode.removeChild(i);for(var r=Object.keys(this).concat(Object.keys(a.Item.prototype)),o=0;o<r.length;o++)this[r[o]]=null},a.Layout=function(t,e){var i=t._settings.layout;if(this.muuri=t,this.items=e?e.concat():t.get("active"),this.slots={},this.width=0,this.height=0,this.setWidth=!1,this.setHeight=!1,this.width=C(t._element,"width"),this.height=C(t._element,"height"),"function"==typeof i)i.call(this);else{var n="string"==typeof i,r=n?i:i[0];if("function"!=typeof a.Layout.methods[r])throw new Error('Layout method "'+method+'" does not exist.');typeof a.Layout.methods[r].call(this,n?{}:i[1])}},a.Layout.methods={firstFit:s},a.defaultSettings={container:null,items:[],positionDuration:300,positionEasing:"ease-out",show:{duration:300,easing:"ease-out"},hide:{duration:300,easing:"ease-out"},layout:"firstFit",layoutOnResize:100,layoutOnInit:!0,dragEnabled:!1,dragContainer:null,dragPredicate:null,dragSort:!0,dragSortInterval:50,dragSortTolerance:50,dragSortAction:"move",dragReleaseDuration:300,dragReleaseEasing:"ease-out",containerClass:"muuri",itemClass:"muuri-item",shownClass:"muuri-shown",hiddenClass:"muuri-hidden",positioningClass:"muuri-positioning",draggingClass:"muuri-dragging",releasingClass:"muuri-releasing"},a});